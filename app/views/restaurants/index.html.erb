<%= content_for "page-attributes" do %>id="restaurantPage" data-cache="never"<% end %>
<% content_for :header do %>
<h1><%= @restaurant.name %> &ndash; <span id="day_title"><%= l(@today, format: "%a, %d. %b") %></span></h1>
	<% 
	#< %= link_to t(".prev_day"), restaurants_path, 'data-icon' => 'arrow-l', 'id' => "prev_day_button", 'data-iconpos' => 'notext', 'data-direction' => 'reverse' % >
	#< %= link_to t(".next_day"), restaurants_path, 'data-icon' => 'arrow-r', 'id' => "next_day_button", 'data-iconpos' => 'notext', 'data-direction' => 'reverse' % >
	%>
<% end %>

<ul id="menus" data-role="listview">
	<li><%= t "please_wait" %></li>
</ul>

<script>
var today = new Date(<%= @today_js %>);
// #TODO: put the following code in the Restaurant class (Restaurant.initMenuView(Date day) or so)
$(document).delegate('#restaurantPage', 'pageshow', function() {
	window.iUPB.enableLoadingIndicator();
	window.iUPB.Restaurant.updateMenus(today);
	$("#restaurantPage").swiperight(function() { // swipe from right to left
	   today = window.iUPB.Restaurant.loadPrevDay(today);
	});
	$("#restaurantPage").swipeleft(function() { // swipe from left to right
	   today = window.iUPB.Restaurant.loadNextDay(today);
	});
	$("#restaurantPage").keydown(function(e){
	    if (e.keyCode == 37) { // left key
	       today = window.iUPB.Restaurant.loadPrevDay(today);
	       return false;
	    }
	});
	$("#restaurantPage").keydown(function(e){
	    if (e.keyCode == 39) { // right key
	       today = window.iUPB.Restaurant.loadNextDay(today);
	       return false;
	    }
	});
});
$('body').delegate('#restaurantPage', 'pagehide', function () { $(this).remove(); });
</script>
